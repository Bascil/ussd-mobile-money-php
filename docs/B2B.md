### B2B API
This API enables Business to Business (B2B) transactions between a business and another business. Use of this API requires a valid and verified B2B M-Pesa short code for the business initiating the transaction and the both businesses involved in the transaction.

### B2B - Resource URL
POST https://sandbox.safaricom.co.ke/mpesa/b2b/v1/paymentrequest

##B2B - Request Parameters

	##Initiator 	
This is the credential/username used to authenticate the transaction request.

	##SecurityCredential 	
Base64 encoded string of the Security Credential, which is encrypted using M-Pesa public key and validates the transaction on M-Pesa Core system.

	##CommandID 	
Unique command for each transaction type, possible values are: BusinessPayBill, MerchantToMerchantTransfer, MerchantTransferFromMerchantToWorking, MerchantServicesMMFAccountTransfer, AgencyFloatAdvance

	##Amount 	
The amount being transacted.

	##PartyA 	
Organization’s short code initiating the transaction.

	##SenderIdentifier 	
Type of organization sending the transaction.

	##PartyB 	
Organization’s short code receiving the funds being transacted.

	##RecieverIdentifierType 	
Type of organization receiving the funds being transacted.

	##Remarks 	
Comments that are sent along with the transaction.

	##QueueTimeOutURL 	
The path that stores information of time out transactions.it should be properly validated to make sure that it contains the port, URI and domain name or publicly available IP.

	##ResultURL 	
The path that receives results from M-Pesa it should be properly validated to make sure that it contains the port, URI and domain name or publicly available IP.

	##AccountReference 	
Account Reference mandatory for “BusinessPaybill” CommandID.


### Sample PHP Request

```
	<?php

	$url = 'https://sandbox.safaricom.co.ke/mpesa/b2b/v1/paymentrequest';

	$curl = curl_init();
	curl_setopt($curl, CURLOPT_URL, $url);
	curl_setopt($curl, CURLOPT_HTTPHEADER, array('Content-Type:application/json','Authorization:Bearer ACCESS_TOKEN')); //setting custom header


	$curl_post_data = array(
	  //Fill in the request parameters with valid values
	  'Initiator' => ' ',
	  'SecurityCredential' => ' ',
	  'CommandID' => ' ',
	  'SenderIdentifierType' => ' ',
	  'RecieverIdentifierType' => ' ',
	  'Amount' => ' ',
	  'PartyA' => ' ',
	  'PartyB' => ' ',
	  'AccountReference' => ' ',
	  'Remarks' => ' ',
	  'QueueTimeOutURL' => 'http://your_timeout_url',
	  'ResultURL' => 'http://your_result_url'
	);

	$data_string = json_encode($curl_post_data);

	curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);
	curl_setopt($curl, CURLOPT_POST, true);
	curl_setopt($curl, CURLOPT_POSTFIELDS, $data_string);

	$curl_response = curl_exec($curl);
	print_r($curl_response);

	echo $curl_response;
	?>

```


## B2B Response Parameters

	##ConversationID 	
A unique numeric code generated by the M-Pesa system of the response to a request.

	##OriginatorConversationID 	
A unique numeric code generated by the M-Pesa system of the request.

	##ResponseDescription 	
A response message from the M-Pesa system accompanying the response to a request.


### Sample JSON Response
```
	{
	
	  "Result":{
	    "ResultType":0,
	    "ResultCode":0,
	    "ResultDesc":"The service request has been accepted successfully.",
	    "OriginatorConversationID":"8551-61996-3",
	    "ConversationID":"AG_20170727_00006baee344f4ce0796",
	    "TransactionID":"LGR519G2QV",
	    "ResultParameters":{
	      "ResultParameter":[
	        {
	          "Key":"InitiatorAccountCurrentBalance",
	          "Value":"{ Amount={BasicAmount=46713.00, MinimumAmount=4671300, CurrencyCode=KES}}"
	        },
	        {
	          "Key":"DebitAccountCurrentBalance",
	          "Value":"{Amount={BasicAmount=46713.00, MinimumAmount=4671300, CurrencyCode=KES}}"
	        },
	        {
	          "Key":"Amount",
	          "Value":10
	        },
	        {
	          "Key":"DebitPartyAffectedAccountBalance",
	          "Value":"Working Account|KES|46713.00|46713.00|0.00|0.00"
	        },
	        {
	          "Key":"TransCompletedTime",
	          "Value":20170727102524
	        },
	        {
	          "Key":"DebitPartyCharges",
	          "Value":"Business Pay Bill Charge|KES|77.00"
	        },
	        {
	          "Key":"ReceiverPartyPublicName",
	          "Value":"603094 - Safaricom3117"
	        },
	        {
	          "Key":"Currency",
	          "Value":"KES"
	        }
	      ]
	    },
	    "ReferenceData":{
	      "ReferenceItem":[
	        {
	          "Key":"BillReferenceNumber",
	          "Value":"aaa"
	        },
	        {
	          "Key":"QueueTimeoutURL",
	          "Value":"https://internalsandbox.safaricom.co.ke/mpesa/b2bresults/v1/submit"
	        },
	        {
	          "Key":"Occasion"
	        }
	      ]
	    }
	  }
	}

```