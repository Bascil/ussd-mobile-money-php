### C2B API

This API enables Paybill and Buy Goods merchants to integrate to M-Pesa and receive real time payments notifications.

### How it works
The C2B Register URL API registers the 3rd partyâ€™s confirmation and validation URLs to M-Pesa ; which then maps these URLs to the 3rd party shortcode. Whenever M-Pesa receives a transaction on the shortcode, M-Pesa triggers a validation request against the validation URL and the 3rd party system responds to M-Pesa with a validation response (either a success or an error code). The response expected is the success code the 3rd party

M-Pesa completes or cancels the transaction depending on the validation response it receives from the 3rd party system. A confirmation request of the transaction is then sent by M-Pesa through the confirmation URL back to the 3rd party which then should respond with a success acknowledging the confirmation.

### C2B Register URL - Resource URL

POST https://sandbox.safaricom.co.ke/mpesa/c2b/v1/registerurl

### C2B Register URL - Request Parameters
 	
#Parameter 			Description
	ValidationURL 	Validation URL for the client.

	ConfirmationURL Confirmation URL for the client.

	ResponseType 	Default response type for timeout.

	ShortCode 		The short code of the organization.

### Sample PHP Request

```
	<?php
	
	$url = 'https://sandbox.safaricom.co.ke/mpesa/c2b/v1/registerurl';

	$curl = curl_init();
	curl_setopt($curl, CURLOPT_URL, $url);
	curl_setopt($curl, CURLOPT_HTTPHEADER, array('Content-Type:application/json','Authorization:Bearer ACCESS_TOKEN')); //setting custom header


	$curl_post_data = array(
	  //Fill in the request parameters with valid values
	  'ShortCode' => ' ',
	  'ResponseType' => ' ',
	  'ConfirmationURL' => 'http://ip_address:port/confirmation',
	  'ValidationURL' => 'http://ip_address:port/validation_url'
	);

	$data_string = json_encode($curl_post_data);

	curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);
	curl_setopt($curl, CURLOPT_POST, true);
	curl_setopt($curl, CURLOPT_POSTFIELDS, $data_string);

	$curl_response = curl_exec($curl);
	print_r($curl_response);

	echo $curl_response;
	?>

```
### Register URL - Response Parameters

	##ConversationID 	
A unique numeric code generated by the M-Pesa system of the response to a request.

	##OriginatorConversationID 	
A unique numeric code generated by the M-Pesa system of the request.

	##ResponseDescription 	
A response message from the M-Pesa system accompanying the response to a request.